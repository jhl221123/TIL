# 트랜잭션(Transaction)

**DB의 작업 처리 단위**

에러나 예외 상황으로 인해 작업이 정상적으로 처리되지 못한 경우, 테이블간의 데이터 정합성을 유지할 수 있도록 진행했던 작업을 모두 롤백시킨다.

## 특징(ACID)

* **원자성(Atomicity)**: 더 이상 분해되지 않는 최소 단위로, 모두 처리되거나 하나도 처리되지 않아야 한다.

* **일관성(Consistency)**: 트랜잭션을 성공적으로 수행하고 나서도 DB는 여전히 일관된 상태여야 한다.

* **격리성(Isolation)**: 작업 환경을 격리시키는 것으로 다른 트랜잭션의 접근을 제한한다.

* **영속성(Durability)**: 트랜잭션으로 수행된 작업 결과는 DB에 영속적으로 저장된다.

# 트랜잭션 격리수준(Transaction Isolation)

다른 트랜잭션의 접근을 완전히 제한하는 것이 아니라 격리 수준에 따라 접근을 제한한다. 격리 수준이 높아질 수록 성능이 저하된다.

## Read Uncommitted

* 커밋, 롤백 여부와 관계없이 다른 트랜잭션에서 모두 조회할 수 있다.
* Dirty Read, Non-Repeatable Read, Phantom Read 발생 가능
* 데이터 정합성에 문제가 있기 때문에 권장하지 않음

## Read Committed

* 변경 내용이 커밋 되어야만 다른 트랜잭션에서 조회할 수 있다.
* 작업 중인 데이터는 Undo 로그에 있는 이전 데이터를 조회
* Non-Repeatable Read, Phantom Read 발생 가능

## Repeatable Read

* 트랜잭션이 시작되기 전에 커밋된 내용까지만 조회할 수 있으며, 다른 트랜잭션에서 수정할 수 없다.
* 해당 트랜잭션 내에서 일관성을 유지하며 작업할 수 있다.
* Phantom Read 발생 가능

## Serializable Read

* 가장 엄격한 격리 수준
* 트랜잭션이 완료될 때까지 다른 트랜잭션이 해당 영역에 대한 수정 및 입력을 할 수 없다.

## 격리 수준에 따른 발생 가능한 문제점

### Dirty Read

* 다른 트랜잭션에 의해 수정됐지만 아직 커밋되지 않은 데이터를 조회할 수 있다.

* 만약 수정한 트랜잭션이 롤백되면 조회한 값은 유효하지 않은 데이터가 된다.

### Non-Repeatable Read

* 한 트랜잭션 내에서 하나의 데이터의 일관성이 유지되지 않는 문제
* 같은 요청을 두 번 수행할 때, 도중에 값의 변경이나 삭제로 인해 발생

### Phantom Read

* 한 트랜잭션 내에서 일정 범위에 대한 데이터를 조회할 때, 일관성이 유지되지 않는 문제
* 해당 범위의 데이터를 두 번 수행할 때, 도중에 값이 추가되거나 수정되어 발생