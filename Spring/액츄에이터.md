# 액츄에이터

**프로덕션 준비 기능을 편리하게 사용할 수 있도록 편의 기능을 제공**

* 엔드포인트를 통해 애플리케이션 정보를 제공한다.
* 내장되어 있는 마이크로미터를 통해 메트릭을 수집한다.
  * 수집한 메트릭은 설정을 통해 노출할 수 있다.
* 애플리케이션 내부의 정보를 노출하기 때문에 보안에 주의해야 한다.
  * 외부 인터넷 접근을 제한하고, 내부에서만 접근할 수 있도록 해야한다.
  * 액츄에이터에 접근할 수 있는 포트를 애플리케이션 포트와 다르게 지정하면 된다.
  * 불가피하게 포트를 변경할 수 없다면 인증된 사용자만 접근 가능하도록 추가 개발이 필요
    * 서블릿 필터, 스프링 시큐리티를 사용(스프링 인터셉터 x)

## 엔트포인트

**액츄에이터가 제공하는 기능**

* 애플리케이션 내부의 수 많은 기능을 관리하고 모니터링 할 수 있도록 지원한다.
* 각 엔드포인트는 활성화 및 노출되어 있어야 사용할 수 있다.
  * 기본적으로 모두 활성화되어 있다. shutdown 제외
  * 활성화가 되어 있더라도 노출하지 않으면 볼 수 없다.
  * web, jmx 등을 선택해서 노출. 보통 web을 사용

### health

* 애플리케이션에 문제가 발생했을 때 빠르게 인지할 수 있다.
* 단순히 요청에 응답할 수 있는지 뿐만 아니라 다양한 정보를 포함해서 만들어진다.
  * DB 연결 상태, 디스크 사용량, PING 등
  * 하나라도 문제가 발생해서 `DOWN` 이라면 전체 상태가 `DOWN`이 된다.

### info

애플리케이션의 기본 정보

* `java`, `os`, `env`, `build`, `git`
  * `java`, `env`, `os` 는 기본적으로 비활성화
  * `build`, `git` 은 별도의 properties 파일이 필요
    * build.gradle에서 task와 plugin으로 자동화 가능
* `endpoint` 하위가 아닌 `management` 하위에 위치하도록 주의해야 한다.

### log

애플리케이션에 사용된 로거의 정보

* 특정 로거의 이름으로 조회 가능
* `configuredLevel`을 조정해서 **운영중에도 실시간으로 로그 레벨을 조정할 수 있다.**

### httpexchanges

* HTTP 요청과 응답 기록을 확인할 수 있다.
  * `HttpExchangeRepository` 인터페이스의 구현체를 빈으로 등록해야 활성화된다.
* 기능이 단순하고 제한이 많아 모니터링 툴이나 **핀포인트**, Zipkin 등 다른 기술을 사용하는 것이 좋다.

### metrics

* JVM, 시스템, 스프링 MVC, 톰캣 등 다양한 메트릭을 제공한다.
  * 톰캣은 기본적으로 세션에 대한 정보만 노출한다.
    * 별도의 설정을 추가하면 스레드 등 유용한 정보를 노출시킬 수 있다.
* tag로 구분해서 원하는 정보만 확인할 수도 있다.
