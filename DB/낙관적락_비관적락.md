# 낙관적 락(Optimistic Lock)

**매번 락을 걸지 않고, 동시성 문제가 발생하면 처리하는 방법**

* 동시성 문제가 발생하지 않을 것이라 가정하고, 일일히 접근을 제한하지 않는다.
* 충돌이 발생하면, 해당 데이터만 접근을 제한한다.
* 보통 version 필드로 충돌을 확인하며, version이 다르면 충돌한 것으로 간주하고 롤백시킨다.
* 낙관적락은 DB에서 처리하는 기능이 아니라 어플리케이션에서 처리하는 동시성 해결 방법이다.
  * 애플리케이션 계층에서 롤백처리 해야한다.

### 장단점

* 매번 락을 사용하지 않기 때문에 성능상 유리하다.
* 충돌이 자주 발생할 경우, 롤백처리 비용이 많아져서 오히려 성능이 나빠질 수 있다.
* 복잡한 트랜잭션의 경우, 롤백처리를 구현하는데 어려움이 있다.

# 비관적 락(Pessimisitc Lock)

**기본적으로 동시성문제가 발생할 것이라 생각하고 매번 접근을 제한하는 방법**

* 하나의 트랜잭션이 자원에 접근하면, 락을 걸고 다른 트랜잭션이 접근하지 못하게 한다.
* **공유락과 배타락으로 구분**되며, DB에서 직접 Lock을 걸어버린다.
  * 공유락(Shared Lock): 다른 트랜잭션은 읽기만 가능하다.
  * 배타락(Exclusive Lock): 다른 트랜잭션은 읽기와 쓰기 모두 불가능하다. 

### 장단점

* 수준높은 데이터 무결성을 보장한다.
* 충돌이 잦은 경우, 롤백 횟수를 줄일 수 있어 성능상 유리하다.
* 데이터 자체에 락을 걸기 때문에 동시성이 떨어진다.
* 서로 자원이 필요한 경우, 데드락이 발생할 가능성이 있다.
