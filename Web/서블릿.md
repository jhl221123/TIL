# 서블릿

자바로 웹 애플리케이션을 개발하기 위해 만들어졌으며, HttpServlet클래스를 상속받아 서블릿 클래스를 구현할 수 있다.

* 서블릿을 등록하려면 다음 두 가지를 설정해야 한다.

  * 서블릿으로 사용할 클래스

  * 서블릿과 URL 간의 매핑

* URL 매핑을 통해 각각의 URL 패턴에 해당하는 서블릿을 지정할 수 있다.

* @WebServlet 애노테이션을 사용하면 웹 컨테이너에서 자동으로 서블릿으로 등록해준다.

* 서블릿 컨테이너는 최초 요청할 때, 서블릿 객체를 생성하고 이후 요청부터는 앞서 생성한 서블릿 객체를 사용한다.

* 웹 컨테이너가 서블릿 객체를 생성하고 init() 메소드를 호출하는 과정을 ‘서블릿 로딩’과정이라고 한다. 서블릿은 init()메소드를 이용해서 필요한 초기화 작업을 수행한다.

* 초기화 작업은 상대적으로 시간이 오래 걸리기 때문에, 처음 서블릿을 사용하는 시점보다는 웹 컨테이너를 처음 구동하는 시점에 초기화를 진행하는 것이 좋다.

## 서블릿 동작 과정

![Alt text](<이미지/서블릿 동작 방식.png>)

* 웹 브라우저가 요청을 보내면 WAS는 Request, Response 객체를 새로 만들어서 서블릿 객체 호출

* Request 객체에서 HTTP 요청 정보를 꺼내서 사용

* Response 객체에 HTTP 응답 정보를 입력

* WAS는 Response 객체에 담겨있는 내용으로 HTTP 응답 정보를 생성

서블릿은 service() 메소드를 호출해서 작업을 처리한다.

```java
protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        String method = req.getMethod();

        if (method.equals(METHOD_GET)) {
          ...
      }
    }
```

## 서블릿 컨테이너
톰캣처럼 서블릿을 지원하는 WAS를 서블릿 컨테이너라고 한다.

* 서블릿 컨테이너는 서블릿 객체의 생명주기를 관리한다.

* 서블릿 객체는 싱글톤으로 관리되기 때문에, 요청은 동일한 서블릿 객체 인스턴스에 접근한다.

* 동시 요청을 위한 멀티 쓰레드 처리를 지원한다.

### 서블릿 컨테이너를 사용해 의미있는 비즈니스 로직에만 집중할 수 있다.

* ~~서버 TCP/IP 대기, 소켓 연결~~

* ~~HTTP 요청 메시지를 파싱~~

* ~~Content-Type 확인~~

* ~~HTTP 메시지 바디 내용 파싱~~

* 비즈니스 로직 실행

* 데이터베이스에 저장 요청

* ~~HTTP 응답 메시지 생성~~

* ~~TCP/IP에 응답 전달, 소켓 종료~~